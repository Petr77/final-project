<h1><%= params[:term] %></h1>

<% if @locations.empty? %>
  Sorry, no accommodation found for this location. Try another.
<% else %>


  <% @locations.each do |l| %>
  <%= link_to l.title, accommodation_path(l) %><br>
  <% end %>

<div id="map"></div>
<script>
  function initMap() {
    // var location =
    var map = new google.maps.Map(document.getElementById('map'), {
      // zoom: 9,
      center: {lat: -33.8697753, lng: 151.2059688}
    });

    var searches = [
      <% @locations.each do |location|%>
        ['<%= location.title %>', <%= location.latitude%>, <%= location.longitude %>],
      <%end%>
    ];

    var bounds = new google.maps.LatLngBounds();

    searches.forEach(function(location){
      var m = new google.maps.Marker({
        map: map,
        position: {lat: location[1], lng: location[2]},
        title: location[0]
      });
      bounds.extend(m.getPosition());
    })
    map.fitBounds(bounds);
  }
</script>
  <script async defer
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAHUFsZfdiSTlWvUkgwPWHwrmzfLAQQJyk&callback=initMap">
  </script>



<% end %>
